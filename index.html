<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>東京都知事選挙2016投票率</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.css" />

    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.3.2/css/bootstrap-combined.min.css" rel="stylesheet">
    <link rel="stylesheet" href="leaflet-simple-sparql-master/css/bootstrap-modal.css" />
    <link rel="stylesheet" href="leaflet-simple-sparql-master/css/MarkerCluster.css" />
    <link rel="stylesheet" href="leaflet-simple-sparql-master/css/MarkerCluster.Default.css" />
<link rel="stylesheet" href="leaflet-simple-sparql-master/css/leaflet.label.css" />





<style type="text/css">
body {margin:0px;padding:0px;}
/* 凡例のスタイル */
.legend {
    line-height: 18px;
    color: #555;
    background-color: white;
    padding: 10;
    border-radius: 10px;
}
.legend i {
    width: 18px;
    height: 18px;
    float: left;
    margin-right: 8px;
    opacity: 0.7;
}
</style>
</head>
<body>

<div id="map" style="width:100%; height:100%"></div>

<!--script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script-->

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" ></script>

<script type="text/javascript" src="jquery-ajaxQueue/dist/jquery.ajaxQueue.min.js"></script>
<script src='Wicket/wicket.js'></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/leaflet.js"></script>
<script src="https://d3js.org/d3.v3.js"></script>
<script type="text/javascript" src="Leaflet.D3SvgOverlay/L.D3SvgOverlay.js"></script>
<script src="spin.min.js"></script>

    <script src="http://uedayou.net/SPARQLTimeliner/js_sparql/sparql.js"></script>
    <script src="leaflet-simple-sparql-master/js/bootstrap-modalmanager.js"></script>
    <script src="leaflet-simple-sparql-master/js/bootstrap-modal.js"></script>
    <script src="leaflet-simple-sparql-master/js/leaflet.markercluster.js"></script>
    <script src="leaflet-simple-sparql-master/js/leaflet.label.js"></script>

    <script src="Leaflet.Spin/leaflet.spin.js"></script>
<script src="config.js"></script>

<!-- script type="text/javascript">

var dataJson;

var map = L.map('map').setView([34.849511,135.623521],13);
var tiles = L.tileLayer('http://tile.openstreetmap.jp/{z}/{x}/{y}.png', {
maxZoom: 18,
attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
});
map.addLayer(tiles);

</script>

<script src="leaflet-sparql.js"></script-->

<script>

// 投票率のデータラベル
var data_label = "人口";

// 投票率のデータ
var data = [
{"uri":"http://uedayou.net/loa/大阪府高槻市赤大路町","人口":1305},
{"uri":"http://uedayou.net/loa/大阪府高槻市芥川町一丁目","人口":684},
{"uri":"http://uedayou.net/loa/大阪府高槻市芥川町二丁目","人口":746},
{"uri":"http://uedayou.net/loa/大阪府高槻市芥川町三丁目","人口":409},
{"uri":"http://uedayou.net/loa/大阪府高槻市芥川町四丁目","人口":470},
{"uri":"http://uedayou.net/loa/大阪府高槻市明田町","人口":361},
{"uri":"http://uedayou.net/loa/大阪府高槻市明野町","人口":1260},
{"uri":"http://uedayou.net/loa/大阪府高槻市朝日町","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市阿武野一丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市阿武野二丁目","人口":29},
{"uri":"http://uedayou.net/loa/大阪府高槻市安満磐手町","人口":38},
{"uri":"http://uedayou.net/loa/大阪府高槻市安満北の町","人口":163},
{"uri":"http://uedayou.net/loa/大阪府高槻市安満御所の町","人口":17},
{"uri":"http://uedayou.net/loa/大阪府高槻市安満新町","人口":82},
{"uri":"http://uedayou.net/loa/大阪府高槻市安満中の町","人口":254},
{"uri":"http://uedayou.net/loa/大阪府高槻市安満西の町","人口":605},
{"uri":"http://uedayou.net/loa/大阪府高槻市安満東の町","人口":216},
{"uri":"http://uedayou.net/loa/大阪府高槻市天川新町","人口":393},
{"uri":"http://uedayou.net/loa/大阪府高槻市天川町","人口":783},
{"uri":"http://uedayou.net/loa/大阪府高槻市安岡寺町一丁目","人口":753},
{"uri":"http://uedayou.net/loa/大阪府高槻市安岡寺町二丁目","人口":558},
{"uri":"http://uedayou.net/loa/大阪府高槻市安岡寺町三丁目","人口":509},
{"uri":"http://uedayou.net/loa/大阪府高槻市安岡寺町四丁目","人口":778},
{"uri":"http://uedayou.net/loa/大阪府高槻市安岡寺町五丁目","人口":928},
{"uri":"http://uedayou.net/loa/大阪府高槻市安岡寺町六丁目","人口":67},
{"uri":"http://uedayou.net/loa/大阪府高槻市井尻一丁目","人口":59},
{"uri":"http://uedayou.net/loa/大阪府高槻市井尻二丁目","人口":97},
{"uri":"http://uedayou.net/loa/大阪府高槻市出灰","人口":28},
{"uri":"http://uedayou.net/loa/大阪府高槻市今城町","人口":761},
{"uri":"http://uedayou.net/loa/大阪府高槻市美しが丘一丁目","人口":380},
{"uri":"http://uedayou.net/loa/大阪府高槻市美しが丘二丁目","人口":206},
{"uri":"http://uedayou.net/loa/大阪府高槻市浦堂一丁目","人口":127},
{"uri":"http://uedayou.net/loa/大阪府高槻市浦堂二丁目","人口":150},
{"uri":"http://uedayou.net/loa/大阪府高槻市浦堂三丁目","人口":300},
{"uri":"http://uedayou.net/loa/大阪府高槻市浦堂本町","人口":482},
{"uri":"http://uedayou.net/loa/大阪府高槻市永楽町","人口":457},
{"uri":"http://uedayou.net/loa/大阪府高槻市大冠町一丁目","人口":235},
{"uri":"http://uedayou.net/loa/大阪府高槻市大冠町二丁目","人口":247},
{"uri":"http://uedayou.net/loa/大阪府高槻市大冠町三丁目","人口":577},
{"uri":"http://uedayou.net/loa/大阪府高槻市大塚町一丁目","人口":574},
{"uri":"http://uedayou.net/loa/大阪府高槻市大塚町二丁目","人口":977},
{"uri":"http://uedayou.net/loa/大阪府高槻市大塚町三丁目","人口":974},
{"uri":"http://uedayou.net/loa/大阪府高槻市大塚町四丁目","人口":242},
{"uri":"http://uedayou.net/loa/大阪府高槻市大塚町五丁目","人口":403},
{"uri":"http://uedayou.net/loa/大阪府高槻市大手町","人口":322},
{"uri":"http://uedayou.net/loa/大阪府高槻市大畑町","人口":1194},
{"uri":"http://uedayou.net/loa/大阪府高槻市岡本町","人口":715},
{"uri":"http://uedayou.net/loa/大阪府高槻市奥天神町一丁目","人口":472},
{"uri":"http://uedayou.net/loa/大阪府高槻市奥天神町二丁目","人口":450},
{"uri":"http://uedayou.net/loa/大阪府高槻市奥天神町三丁目","人口":99},
{"uri":"http://uedayou.net/loa/大阪府高槻市梶原一丁目","人口":130},
{"uri":"http://uedayou.net/loa/大阪府高槻市梶原二丁目","人口":46},
{"uri":"http://uedayou.net/loa/大阪府高槻市梶原三丁目","人口":88},
{"uri":"http://uedayou.net/loa/大阪府高槻市梶原四丁目","人口":92},
{"uri":"http://uedayou.net/loa/大阪府高槻市梶原五丁目","人口":48},
{"uri":"http://uedayou.net/loa/大阪府高槻市梶原六丁目","人口":13},
{"uri":"http://uedayou.net/loa/大阪府高槻市梶原中村町","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市春日町","人口":1229},
{"uri":"http://uedayou.net/loa/大阪府高槻市上田辺町","人口":718},
{"uri":"http://uedayou.net/loa/大阪府高槻市上土室一丁目","人口":1068},
{"uri":"http://uedayou.net/loa/大阪府高槻市上土室二丁目","人口":392},
{"uri":"http://uedayou.net/loa/大阪府高槻市上土室三丁目","人口":781},
{"uri":"http://uedayou.net/loa/大阪府高槻市上土室四丁目","人口":344},
{"uri":"http://uedayou.net/loa/大阪府高槻市上土室五丁目","人口":198},
{"uri":"http://uedayou.net/loa/大阪府高槻市上土室六丁目","人口":558},
{"uri":"http://uedayou.net/loa/大阪府高槻市上本町","人口":541},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎北一丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎北二丁目","人口":19},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎北三丁目","人口":24},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎中一丁目","人口":153},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎中二丁目","人口":161},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎中三丁目","人口":170},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎中四丁目","人口":266},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎西一丁目","人口":245},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎西二丁目","人口":257},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎南一丁目","人口":15},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎南二丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市唐崎南三丁目","人口":38},
{"uri":"http://uedayou.net/loa/大阪府高槻市花林苑","人口":638},
{"uri":"http://uedayou.net/loa/大阪府高槻市川久保","人口":26},
{"uri":"http://uedayou.net/loa/大阪府高槻市川添一丁目","人口":449},
{"uri":"http://uedayou.net/loa/大阪府高槻市川添二丁目","人口":803},
{"uri":"http://uedayou.net/loa/大阪府高槻市川西町一丁目","人口":1186},
{"uri":"http://uedayou.net/loa/大阪府高槻市川西町二丁目","人口":622},
{"uri":"http://uedayou.net/loa/大阪府高槻市川西町三丁目","人口":232},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧山手町","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧北駅前町","人口":449},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧南駅前町","人口":254},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧町一丁目","人口":124},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧町二丁目","人口":286},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧町三丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧町四丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市上牧町五丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市北大樋町","人口":1259},
{"uri":"http://uedayou.net/loa/大阪府高槻市北昭和台町","人口":556},
{"uri":"http://uedayou.net/loa/大阪府高槻市北園町","人口":468},
{"uri":"http://uedayou.net/loa/大阪府高槻市北柳川町","人口":513},
{"uri":"http://uedayou.net/loa/大阪府高槻市京口町","人口":369},
{"uri":"http://uedayou.net/loa/大阪府高槻市郡家新町","人口":1806},
{"uri":"http://uedayou.net/loa/大阪府高槻市郡家本町","人口":573},
{"uri":"http://uedayou.net/loa/大阪府高槻市高西町","人口":549},
{"uri":"http://uedayou.net/loa/大阪府高槻市神内","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市神内一丁目","人口":53},
{"uri":"http://uedayou.net/loa/大阪府高槻市神内二丁目","人口":766},
{"uri":"http://uedayou.net/loa/大阪府高槻市黄金の里一丁目","人口":218},
{"uri":"http://uedayou.net/loa/大阪府高槻市古曽部町一丁目","人口":762},
{"uri":"http://uedayou.net/loa/大阪府高槻市古曽部町二丁目","人口":1415},
{"uri":"http://uedayou.net/loa/大阪府高槻市古曽部町三丁目","人口":454},
{"uri":"http://uedayou.net/loa/大阪府高槻市古曽部町四丁目","人口":184},
{"uri":"http://uedayou.net/loa/大阪府高槻市古曽部町五丁目","人口":116},
{"uri":"http://uedayou.net/loa/大阪府高槻市寿町一丁目","人口":606},
{"uri":"http://uedayou.net/loa/大阪府高槻市寿町二丁目","人口":1022},
{"uri":"http://uedayou.net/loa/大阪府高槻市寿町三丁目","人口":862},
{"uri":"http://uedayou.net/loa/大阪府高槻市紺屋町","人口":147},
{"uri":"http://uedayou.net/loa/大阪府高槻市五領町","人口":223},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面北一丁目","人口":19},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面北二丁目","人口":26},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面中一丁目","人口":120},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面中二丁目","人口":223},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面南一丁目","人口":24},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面南二丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面南三丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市西面南四丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市幸町","人口":104},
{"uri":"http://uedayou.net/loa/大阪府高槻市栄町一丁目","人口":745},
{"uri":"http://uedayou.net/loa/大阪府高槻市栄町二丁目","人口":1160},
{"uri":"http://uedayou.net/loa/大阪府高槻市栄町三丁目","人口":268},
{"uri":"http://uedayou.net/loa/大阪府高槻市栄町四丁目","人口":723},
{"uri":"http://uedayou.net/loa/大阪府高槻市桜ケ丘北町","人口":604},
{"uri":"http://uedayou.net/loa/大阪府高槻市桜ケ丘南町","人口":493},
{"uri":"http://uedayou.net/loa/大阪府高槻市桜町","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市沢良木町","人口":935},
{"uri":"http://uedayou.net/loa/大阪府高槻市三箇牧一丁目","人口":19},
{"uri":"http://uedayou.net/loa/大阪府高槻市三箇牧二丁目","人口":3},
{"uri":"http://uedayou.net/loa/大阪府高槻市芝谷町","人口":667},
{"uri":"http://uedayou.net/loa/大阪府高槻市芝生町一丁目","人口":1380},
{"uri":"http://uedayou.net/loa/大阪府高槻市芝生町二丁目","人口":2170},
{"uri":"http://uedayou.net/loa/大阪府高槻市芝生町三丁目","人口":983},
{"uri":"http://uedayou.net/loa/大阪府高槻市芝生町四丁目","人口":437},
{"uri":"http://uedayou.net/loa/大阪府高槻市清水台一丁目","人口":373},
{"uri":"http://uedayou.net/loa/大阪府高槻市清水台二丁目","人口":203},
{"uri":"http://uedayou.net/loa/大阪府高槻市下","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市下田部町一丁目","人口":844},
{"uri":"http://uedayou.net/loa/大阪府高槻市下田部町二丁目","人口":274},
{"uri":"http://uedayou.net/loa/大阪府高槻市庄所町","人口":971},
{"uri":"http://uedayou.net/loa/大阪府高槻市昭和台町一丁目","人口":215},
{"uri":"http://uedayou.net/loa/大阪府高槻市昭和台町二丁目","人口":386},
{"uri":"http://uedayou.net/loa/大阪府高槻市城西町","人口":935},
{"uri":"http://uedayou.net/loa/大阪府高槻市城東町","人口":337},
{"uri":"http://uedayou.net/loa/大阪府高槻市城内町","人口":90},
{"uri":"http://uedayou.net/loa/大阪府高槻市城南町一丁目","人口":792},
{"uri":"http://uedayou.net/loa/大阪府高槻市城南町二丁目","人口":519},
{"uri":"http://uedayou.net/loa/大阪府高槻市城南町三丁目","人口":511},
{"uri":"http://uedayou.net/loa/大阪府高槻市城南町四丁目","人口":732},
{"uri":"http://uedayou.net/loa/大阪府高槻市城北町一丁目","人口":399},
{"uri":"http://uedayou.net/loa/大阪府高槻市城北町二丁目","人口":328},
{"uri":"http://uedayou.net/loa/大阪府高槻市須賀町","人口":828},
{"uri":"http://uedayou.net/loa/大阪府高槻市杉生","人口":19},
{"uri":"http://uedayou.net/loa/大阪府高槻市辻子一丁目","人口":599},
{"uri":"http://uedayou.net/loa/大阪府高槻市辻子二丁目","人口":421},
{"uri":"http://uedayou.net/loa/大阪府高槻市辻子三丁目","人口":1014},
{"uri":"http://uedayou.net/loa/大阪府高槻市清福寺町","人口":699},
{"uri":"http://uedayou.net/loa/大阪府高槻市高垣町","人口":1466},
{"uri":"http://uedayou.net/loa/大阪府高槻市高槻町","人口":387},
{"uri":"http://uedayou.net/loa/大阪府高槻市高見台","人口":285},
{"uri":"http://uedayou.net/loa/大阪府高槻市竹の内町","人口":1217},
{"uri":"http://uedayou.net/loa/大阪府高槻市田能","人口":90},
{"uri":"http://uedayou.net/loa/大阪府高槻市玉川一丁目","人口":314},
{"uri":"http://uedayou.net/loa/大阪府高槻市玉川二丁目","人口":1223},
{"uri":"http://uedayou.net/loa/大阪府高槻市玉川三丁目","人口":16},
{"uri":"http://uedayou.net/loa/大阪府高槻市玉川四丁目","人口":55},
{"uri":"http://uedayou.net/loa/大阪府高槻市玉川新町","人口":133},
{"uri":"http://uedayou.net/loa/大阪府高槻市大学町","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市大蔵司一丁目","人口":404},
{"uri":"http://uedayou.net/loa/大阪府高槻市大蔵司二丁目","人口":722},
{"uri":"http://uedayou.net/loa/大阪府高槻市大蔵司三丁目","人口":356},
{"uri":"http://uedayou.net/loa/大阪府高槻市大和一丁目","人口":564},
{"uri":"http://uedayou.net/loa/大阪府高槻市大和二丁目","人口":145},
{"uri":"http://uedayou.net/loa/大阪府高槻市千代田町","人口":927},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚原一丁目","人口":997},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚原二丁目","人口":1046},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚原三丁目","人口":456},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚原四丁目","人口":472},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚原五丁目","人口":267},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚原六丁目","人口":387},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚脇一丁目","人口":538},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚脇二丁目","人口":25},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚脇三丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚脇四丁目","人口":18},
{"uri":"http://uedayou.net/loa/大阪府高槻市塚脇五丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市月見町","人口":618},
{"uri":"http://uedayou.net/loa/大阪府高槻市堤町","人口":152},
{"uri":"http://uedayou.net/loa/大阪府高槻市津之江北町","人口":1097},
{"uri":"http://uedayou.net/loa/大阪府高槻市津之江町一丁目","人口":2133},
{"uri":"http://uedayou.net/loa/大阪府高槻市津之江町二丁目","人口":1312},
{"uri":"http://uedayou.net/loa/大阪府高槻市津之江町三丁目","人口":1049},
{"uri":"http://uedayou.net/loa/大阪府高槻市寺谷町","人口":914},
{"uri":"http://uedayou.net/loa/大阪府高槻市天神町一丁目","人口":232},
{"uri":"http://uedayou.net/loa/大阪府高槻市天神町二丁目","人口":783},
{"uri":"http://uedayou.net/loa/大阪府高槻市天王町","人口":448},
{"uri":"http://uedayou.net/loa/大阪府高槻市出丸町","人口":578},
{"uri":"http://uedayou.net/loa/大阪府高槻市桃園町","人口":52},
{"uri":"http://uedayou.net/loa/大阪府高槻市東和町","人口":628},
{"uri":"http://uedayou.net/loa/大阪府高槻市殿町","人口":629},
{"uri":"http://uedayou.net/loa/大阪府高槻市登美の里町","人口":403},
{"uri":"http://uedayou.net/loa/大阪府高槻市富田丘町","人口":1497},
{"uri":"http://uedayou.net/loa/大阪府高槻市富田町一丁目","人口":901},
{"uri":"http://uedayou.net/loa/大阪府高槻市富田町二丁目","人口":453},
{"uri":"http://uedayou.net/loa/大阪府高槻市富田町三丁目","人口":357},
{"uri":"http://uedayou.net/loa/大阪府高槻市富田町四丁目","人口":371},
{"uri":"http://uedayou.net/loa/大阪府高槻市富田町五丁目","人口":811},
{"uri":"http://uedayou.net/loa/大阪府高槻市富田町六丁目","人口":484},
{"uri":"http://uedayou.net/loa/大阪府高槻市道鵜町一丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市道鵜町二丁目","人口":37},
{"uri":"http://uedayou.net/loa/大阪府高槻市道鵜町三丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市道鵜町四丁目","人口":78},
{"uri":"http://uedayou.net/loa/大阪府高槻市道鵜町五丁目","人口":433},
{"uri":"http://uedayou.net/loa/大阪府高槻市道鵜町六丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市土橋町","人口":526},
{"uri":"http://uedayou.net/loa/大阪府高槻市中川町","人口":536},
{"uri":"http://uedayou.net/loa/大阪府高槻市中畑","人口":31},
{"uri":"http://uedayou.net/loa/大阪府高槻市奈佐原","人口":74},
{"uri":"http://uedayou.net/loa/大阪府高槻市奈佐原一丁目","人口":724},
{"uri":"http://uedayou.net/loa/大阪府高槻市奈佐原二丁目","人口":1431},
{"uri":"http://uedayou.net/loa/大阪府高槻市奈佐原三丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市奈佐原四丁目","人口":491},
{"uri":"http://uedayou.net/loa/大阪府高槻市奈佐原元町","人口":268},
{"uri":"http://uedayou.net/loa/大阪府高槻市成合","人口":39},
{"uri":"http://uedayou.net/loa/大阪府高槻市成合北の町","人口":79},
{"uri":"http://uedayou.net/loa/大阪府高槻市成合中の町","人口":139},
{"uri":"http://uedayou.net/loa/大阪府高槻市成合西の町","人口":12},
{"uri":"http://uedayou.net/loa/大阪府高槻市成合東の町","人口":91},
{"uri":"http://uedayou.net/loa/大阪府高槻市成合南の町","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市南平台一丁目","人口":619},
{"uri":"http://uedayou.net/loa/大阪府高槻市南平台二丁目","人口":218},
{"uri":"http://uedayou.net/loa/大阪府高槻市南平台三丁目","人口":575},
{"uri":"http://uedayou.net/loa/大阪府高槻市南平台四丁目","人口":492},
{"uri":"http://uedayou.net/loa/大阪府高槻市南平台五丁目","人口":1021},
{"uri":"http://uedayou.net/loa/大阪府高槻市西大樋町","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市西冠一丁目","人口":503},
{"uri":"http://uedayou.net/loa/大阪府高槻市西冠二丁目","人口":395},
{"uri":"http://uedayou.net/loa/大阪府高槻市西冠三丁目","人口":758},
{"uri":"http://uedayou.net/loa/大阪府高槻市西之川原一丁目","人口":117},
{"uri":"http://uedayou.net/loa/大阪府高槻市西之川原二丁目","人口":161},
{"uri":"http://uedayou.net/loa/大阪府高槻市西真上一丁目","人口":1014},
{"uri":"http://uedayou.net/loa/大阪府高槻市西真上二丁目","人口":257},
{"uri":"http://uedayou.net/loa/大阪府高槻市西町","人口":1336},
{"uri":"http://uedayou.net/loa/大阪府高槻市西五百住町","人口":448},
{"uri":"http://uedayou.net/loa/大阪府高槻市如是町","人口":1066},
{"uri":"http://uedayou.net/loa/大阪府高槻市二料","人口":35},
{"uri":"http://uedayou.net/loa/大阪府高槻市野田一丁目","人口":393},
{"uri":"http://uedayou.net/loa/大阪府高槻市野田二丁目","人口":644},
{"uri":"http://uedayou.net/loa/大阪府高槻市野田三丁目","人口":962},
{"uri":"http://uedayou.net/loa/大阪府高槻市野田四丁目","人口":301},
{"uri":"http://uedayou.net/loa/大阪府高槻市野田東一丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市野田東二丁目","人口":13},
{"uri":"http://uedayou.net/loa/大阪府高槻市登町","人口":2973},
{"uri":"http://uedayou.net/loa/大阪府高槻市野見町","人口":434},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩谷","人口":89},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩谷月見台","人口":129},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩之庄","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩之庄一丁目","人口":100},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩之庄二丁目","人口":80},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩之庄三丁目","人口":86},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩之庄四丁目","人口":20},
{"uri":"http://uedayou.net/loa/大阪府高槻市萩之庄五丁目","人口":232},
{"uri":"http://uedayou.net/loa/大阪府高槻市白梅町","人口":1037},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本一丁目","人口":75},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本二丁目","人口":78},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本三丁目","人口":112},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本四丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本五丁目","人口":56},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本六丁目","人口":509},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本七丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本新町","人口":1784},
{"uri":"http://uedayou.net/loa/大阪府高槻市柱本南町","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市八丁畷町","人口":343},
{"uri":"http://uedayou.net/loa/大阪府高槻市八丁西町","人口":408},
{"uri":"http://uedayou.net/loa/大阪府高槻市土室町","人口":875},
{"uri":"http://uedayou.net/loa/大阪府高槻市原","人口":633},
{"uri":"http://uedayou.net/loa/大阪府高槻市番田一丁目","人口":35},
{"uri":"http://uedayou.net/loa/大阪府高槻市番田二丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市東天川一丁目","人口":123},
{"uri":"http://uedayou.net/loa/大阪府高槻市東天川二丁目","人口":96},
{"uri":"http://uedayou.net/loa/大阪府高槻市東天川三丁目","人口":339},
{"uri":"http://uedayou.net/loa/大阪府高槻市東天川四丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市東天川五丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市東上牧一丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市東上牧二丁目","人口":519},
{"uri":"http://uedayou.net/loa/大阪府高槻市東上牧三丁目","人口":390},
{"uri":"http://uedayou.net/loa/大阪府高槻市東城山町","人口":317},
{"uri":"http://uedayou.net/loa/大阪府高槻市東五百住町一丁目","人口":840},
{"uri":"http://uedayou.net/loa/大阪府高槻市東五百住町二丁目","人口":763},
{"uri":"http://uedayou.net/loa/大阪府高槻市東五百住町三丁目","人口":621},
{"uri":"http://uedayou.net/loa/大阪府高槻市氷室町一丁目","人口":1062},
{"uri":"http://uedayou.net/loa/大阪府高槻市氷室町二丁目","人口":1382},
{"uri":"http://uedayou.net/loa/大阪府高槻市氷室町三丁目","人口":292},
{"uri":"http://uedayou.net/loa/大阪府高槻市氷室町四丁目","人口":501},
{"uri":"http://uedayou.net/loa/大阪府高槻市氷室町五丁目","人口":18},
{"uri":"http://uedayou.net/loa/大阪府高槻市氷室町六丁目","人口":24},
{"uri":"http://uedayou.net/loa/大阪府高槻市日向町","人口":603},
{"uri":"http://uedayou.net/loa/大阪府高槻市日吉台一番町","人口":416},
{"uri":"http://uedayou.net/loa/大阪府高槻市日吉台二番町","人口":397},
{"uri":"http://uedayou.net/loa/大阪府高槻市日吉台三番町","人口":544},
{"uri":"http://uedayou.net/loa/大阪府高槻市日吉台四番町","人口":430},
{"uri":"http://uedayou.net/loa/大阪府高槻市日吉台五番町","人口":422},
{"uri":"http://uedayou.net/loa/大阪府高槻市日吉台六番町","人口":779},
{"uri":"http://uedayou.net/loa/大阪府高槻市日吉台七番町","人口":463},
{"uri":"http://uedayou.net/loa/大阪府高槻市深沢町一丁目","人口":630},
{"uri":"http://uedayou.net/loa/大阪府高槻市深沢町二丁目","人口":585},
{"uri":"http://uedayou.net/loa/大阪府高槻市深沢本町","人口":559},
{"uri":"http://uedayou.net/loa/大阪府高槻市藤の里町","人口":567},
{"uri":"http://uedayou.net/loa/大阪府高槻市別所新町","人口":219},
{"uri":"http://uedayou.net/loa/大阪府高槻市別所中の町","人口":768},
{"uri":"http://uedayou.net/loa/大阪府高槻市別所本町","人口":1513},
{"uri":"http://uedayou.net/loa/大阪府高槻市紅茸町","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市本町","人口":301},
{"uri":"http://uedayou.net/loa/大阪府高槻市前島一丁目","人口":120},
{"uri":"http://uedayou.net/loa/大阪府高槻市前島二丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市前島三丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市前島四丁目","人口":-1},
{"uri":"http://uedayou.net/loa/大阪府高槻市前島五丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市真上町一丁目","人口":931},
{"uri":"http://uedayou.net/loa/大阪府高槻市真上町二丁目","人口":683},
{"uri":"http://uedayou.net/loa/大阪府高槻市真上町三丁目","人口":377},
{"uri":"http://uedayou.net/loa/大阪府高槻市真上町四丁目","人口":504},
{"uri":"http://uedayou.net/loa/大阪府高槻市真上町五丁目","人口":792},
{"uri":"http://uedayou.net/loa/大阪府高槻市真上町六丁目","人口":1395},
{"uri":"http://uedayou.net/loa/大阪府高槻市牧田町","人口":3235},
{"uri":"http://uedayou.net/loa/大阪府高槻市松川町","人口":382},
{"uri":"http://uedayou.net/loa/大阪府高槻市松が丘一丁目","人口":643},
{"uri":"http://uedayou.net/loa/大阪府高槻市松が丘二丁目","人口":727},
{"uri":"http://uedayou.net/loa/大阪府高槻市松が丘三丁目","人口":691},
{"uri":"http://uedayou.net/loa/大阪府高槻市松が丘四丁目","人口":480},
{"uri":"http://uedayou.net/loa/大阪府高槻市松原町","人口":389},
{"uri":"http://uedayou.net/loa/大阪府高槻市三島江","人口":10},
{"uri":"http://uedayou.net/loa/大阪府高槻市三島江一丁目","人口":40},
{"uri":"http://uedayou.net/loa/大阪府高槻市三島江二丁目","人口":133},
{"uri":"http://uedayou.net/loa/大阪府高槻市三島江三丁目","人口":46},
{"uri":"http://uedayou.net/loa/大阪府高槻市三島江四丁目","人口":173},
{"uri":"http://uedayou.net/loa/大阪府高槻市緑が丘一丁目","人口":454},
{"uri":"http://uedayou.net/loa/大阪府高槻市緑が丘二丁目","人口":486},
{"uri":"http://uedayou.net/loa/大阪府高槻市緑が丘三丁目","人口":142},
{"uri":"http://uedayou.net/loa/大阪府高槻市緑町","人口":504},
{"uri":"http://uedayou.net/loa/大阪府高槻市南芥川町","人口":1023},
{"uri":"http://uedayou.net/loa/大阪府高槻市南大樋町","人口":681},
{"uri":"http://uedayou.net/loa/大阪府高槻市南庄所町","人口":386},
{"uri":"http://uedayou.net/loa/大阪府高槻市南総持寺町","人口":847},
{"uri":"http://uedayou.net/loa/大阪府高槻市南松原町","人口":469},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮が谷町","人口":140},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮田町一丁目","人口":698},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮田町二丁目","人口":952},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮田町三丁目","人口":720},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮之川原一丁目","人口":122},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮之川原二丁目","人口":149},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮之川原三丁目","人口":283},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮之川原四丁目","人口":367},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮之川原五丁目","人口":452},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮之川原元町","人口":265},
{"uri":"http://uedayou.net/loa/大阪府高槻市宮野町","人口":1546},
{"uri":"http://uedayou.net/loa/大阪府高槻市紫町","人口":275},
{"uri":"http://uedayou.net/loa/大阪府高槻市名神町","人口":333},
{"uri":"http://uedayou.net/loa/大阪府高槻市柳川町一丁目","人口":303},
{"uri":"http://uedayou.net/loa/大阪府高槻市柳川町二丁目","人口":410},
{"uri":"http://uedayou.net/loa/大阪府高槻市八幡町","人口":725},
{"uri":"http://uedayou.net/loa/大阪府高槻市山手町一丁目","人口":325},
{"uri":"http://uedayou.net/loa/大阪府高槻市山手町二丁目","人口":68},
{"uri":"http://uedayou.net/loa/大阪府高槻市弥生が丘町","人口":1021},
{"uri":"http://uedayou.net/loa/大阪府高槻市淀の原町","人口":1592},
{"uri":"http://uedayou.net/loa/大阪府高槻市霊仙寺町一丁目","人口":23},
{"uri":"http://uedayou.net/loa/大阪府高槻市霊仙寺町二丁目","人口":0},
{"uri":"http://uedayou.net/loa/大阪府高槻市若松町","人口":570},
];

// 投票率データの階級区分
var data_grades = [ 
0,
500, 
1000, 
1500,
2000,
2500,
3000
];


// 投票率に応じて塗りつぶし色を変更
function getColor(d) {
	return d > data_grades[6]  ? '#800026' :
	d > data_grades[5]  ? '#BD0026' :
	d > data_grades[4]  ? '#E31A1C' :
	d > data_grades[3]  ? '#FC4E2A' :
	d > data_grades[2]  ? '#FD8D3C' :
	d > data_grades[1]  ? '#FEB24C' :
	d > data_grades[0]  ? '#FED976' :
			  '#FFEDA0' ;
}

// 投票率の最小値を取得(使ってない)
var min = d3.min(data, function (e) {
    return e[data_label];
});

// 投票率の最大値を取得(使ってない)
var max = d3.max(data, function (e) {
    return e[data_label];
});

// Leafletによる地図表示
var map = L.map('map').setView([34.849511,135.623521],13);
var tiles = L.tileLayer('http://tile.openstreetmap.jp/{z}/{x}/{y}.png', {
maxZoom: 18,
attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
});
map.addLayer(tiles);

// 凡例
var legend = L.control({position: 'bottomright'});
legend.onAdd = function (map) {
    var div = L.DomUtil.create('div', 'info legend'),
        //grades = [53, 55, 57, 59, 61, 63, 65, 70],
        grades = data_grades,
        labels = [];
    for (var i = 0; i < grades.length; i++) {
        div.innerHTML +=
            '<i style="background:' + getColor(grades[i] + 1) + '"></i> ' +
            grades[i] + (grades[i + 1] ? '&ndash;' + grades[i + 1] + '<br>' : '+');
    }
    return div;
};
legend.addTo(map);

console.log("start loading.");
map.spin(true);
$.each(data, function(i,d){
	if (d.uri.lastIndexOf('http://uedayou.net/loa/', 0) !== 0) {
		d.uri = 'http://uedayou.net/loa/'+d.uri;
	}
	loadPolygonFromLOAJ(d.uri, data[i]);
});





    //$('body').modalmanager('loading').find('.modal-scrollable').off('click.modalmanager');    
    qr = sendQuery(endpoint, query);
    qr.fail(
        function (xhr, textStatus, thrownError) {
            //$('body').modalmanager('removeLoading');
            alert("Error: A '" + textStatus+ "' occurred.");
        }
    );
    qr.done(
        function (json) {
            var dataJson = [];
            for(var i=0;i<json.results.bindings.length;i++) {
                dataJson.push(_convSparqlJsonToGeoJson(json.results.bindings[i]));
            }
            //points.addData(dataJson);
            //map.addLayer(points);
                
L.geoJson(dataJson).addTo(map);

        }
    );

/*
    $("#clear").click(function(evt){
        evt.preventDefault();
        $("#filter-string").val("").focus();
        addSparqlJsonMarkers();
    });
*/

var popupOpts = {
    autoPanPadding: new L.Point(5, 50),
    autoPan: true
};

var points = L.geoJson(null, {
    onEachFeature: function (feature, layer) {
        var popup = '<div class="popup-content"><table class="table table-striped table-bordered table-condensed">';
        for (var clave in feature.properties) {
            var title = clave;
            var attr = feature.properties[clave];
            if (title == labelColumn) {
                layer.bindLabel(feature.properties[clave], {className: 'map-label'});
            }
            if (typeof attr === 'string' && attr.indexOf('http') === 0 && attr.indexOf(".jpg") > 0) {
                attr = '<a target="_blank" href="' + attr + '"><img src="'+attr+'" style="width:100%;" /></a>';
            }
            if (typeof attr === 'string' && attr.indexOf('http') === 0) {
                attr = '<a target="_blank" href="' + attr + '">'+ attr + '</a>';
            }
            if (attr) {
                popup += '<tr><th>'+title+'</th><td>'+ attr +'</td></tr>';
            }
        }
        popup += "</table></popup-content>";
        layer.bindPopup(popup, popupOpts);
    }
/*
    ,
    filter: function(feature, layer) {
        total += 1;
        if (!filterString) {
            hits += 1;
            return true;
        }
        var hit = false;
        var lowerFilterString = filterString.toLowerCase().strip();
        $.each(feature.properties, function(k, v) {
            var value = v.toLowerCase();
            if (value.indexOf(lowerFilterString) !== -1) {
                hit = true;
                hits += 1;
                return false;
            }
        });
        return hit;
    }
*/
});

_convSparqlJsonToGeoJson = function(data) {
    var json = {};
    json["type"] = "Feature";
    json["properties"] = _getProperties(data);
    json["geometry"] = {"type" :"Point"};
    json["geometry"]["coordinates"] = [data[labelLongitude].value, data[labelLatitude].value];
    return json;
}


_getProperties = function(data) {
    var props = {};
    jQuery.each(data, function(key, value) {
        props[key] = value.value;
/*
        var item = value.value.replace(/"/g,'');
        if (item.indexOf("http") !== 0 && isNaN(parseFloat(item))) {
            typeAheadSource.push(item);
            var words = item.split(/\W+/);
            for (var k = words.length - 1; k >= 0; k--) {
                typeAheadSource.push(words[k]);
            }
        }
*/
    });
    return props;
}


function loadPolygonFromLOAJ(uri, option) {
	var url = window.location.protocol=="https:"?uri.replace(/^http:/i,"https:"):uri;
	$.ajaxQueue({
	    url: url+".json"
	}).done(function( json ) {
		//console.log(uri);
		var json = json[uri];
		if ("http://www.opengis.net/ont/geosparql#wktLiteral" in json) ; else return;
		var label = json["http://www.w3.org/2000/01/rdf-schema#label"][0]["value"];
		var wkt = json["http://www.opengis.net/ont/geosparql#wktLiteral"][0]["value"];
		var _geoArray = new Array();
		var _o = new Object();
		_o["type"] = "Feature";
		wicket = new Wkt.Wkt();
		wicket.read(wkt);
		var obj = wicket.toJson();
		_o["geometry"] = obj;
		_o["properties"] = {};
		_o["properties"]["name"] = label;
		_o["properties"][data_label] = option[data_label];
		var importance = [];
		if (obj.type == "MultiPolygon") {
			var mx = 0;
			$.each(obj.coordinates, function(i,_d){
				var area = polygonArea(_d[0],_d[0].length);
				if (mx<area) {
					importance = _d[0];
					mx = area;
				}
			});
		}
		else importance = obj.coordinates[0];
		_o["internal"] = {"center":getCentroid2(importance)};
		_geoArray[0] = _o;

		// tooltip
		var TooltipMarker = '';

		// leaflet.D3SvgOverlay
		// https://github.com/teralytics/Leaflet.D3SvgOverlay
		var d3Layer = L.d3SvgOverlay(function(sel, proj) {
			var upd = sel.selectAll('path').data(_geoArray);
			upd.enter()
		    .append('path')
		    .attr('d', proj.pathFromGeojson)
		    .attr('stroke', 'black')
		    .attr('fill', function(){
		    	//var color = d3.interpolate("khaki", "red");
		    	//return color((option[data_label]-min)/(max-min))
		    	
		    	// 投票率に応じて塗りつぶし色を変更
			    return getColor(option[data_label]);
			})
		    .attr('fill-opacity', '0.8');
			upd.attr('stroke-width', 1 / proj.scale);
			upd.on('mouseover', function(d) {
          		var Lati = d.internal.center[1];
          		var Longi = d.internal.center[0];

          		if (!isFinite(Lati)||!isFinite(Longi)) return;

		        var markerIcon = L.icon({
		            iconUrl: 'Empty_Icon.png',
		            iconSize: [38, 95],
		            shadowSize: [50, 64],
		            iconAnchor: [Lati, Longi],
		        });

		        TooltipMarker = new L.Marker([Lati, Longi], {
		            icon: markerIcon
		        });
		        map.addLayer(TooltipMarker);

				var out =[];
				for(var key in d.properties){
					out.push("<strong>"+key+"</strong>: "+d.properties[key]);
				}
		        TooltipMarker.bindPopup(out.join("<br/>"));
		        TooltipMarker.openPopup();
	        })
			.on('mouseout', function(d) {
				if (TooltipMarker != '') map.removeLayer(TooltipMarker);
	        });
		});
		//

		map.addLayer(d3Layer);
		if (data[data.length-1].uri == uri) {
			console.log("finished loading.");
			map.spin(false);
		}
	});
}

// http://stackoverflow.com/questions/22796520/finding-the-center-of-leaflet-polygon
var getCentroid2 = function (arr) {
    var twoTimesSignedArea = 0;
    var cxTimes6SignedArea = 0;
    var cyTimes6SignedArea = 0;

    var length = arr.length

    var x = function (i) { return parseFloat(arr[i % length][0]) };
    var y = function (i) { return parseFloat(arr[i % length][1]) };

    for ( var i = 0; i < arr.length; i++) {
        var twoSA = x(i)*y(i+1) - x(i+1)*y(i);
        twoTimesSignedArea += twoSA;
        cxTimes6SignedArea += (x(i) + x(i+1)) * twoSA;
        cyTimes6SignedArea += (y(i) + y(i+1)) * twoSA;
    }
    var sixSignedArea = 3 * twoTimesSignedArea;
    return [ cxTimes6SignedArea / sixSignedArea, cyTimes6SignedArea / sixSignedArea];        
}

function polygonArea(coord, numPoints) { 
  area = 0;
  j = numPoints-1;
  for (i=0; i<numPoints; i++){
  	area = area +  (coord[j][0]+coord[i][0]) * (coord[j][1]-coord[i][1]); 
    j = i;
  }
  return area/2;
}

</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-45357765-1', 'auto');
  ga('send', 'pageview');

</script>

</body>
</html>
